{% extends 'layout.html' %}

{% block content %}

<!-- Dashboard Layout -->
<div class="flex flex-col md:flex-row gap-6">

  <!-- Left Panel: Chart -->
  <div class="flex-1 bg-midcolor p-4 rounded-lg shadow-md">
    <!-- Quiz Max Streak -->
    <div class="rounded-xl p-4">
      <h2 class="text-xl font-semibold mb-4">Quiz Max Streak & Question Count</h2>
      <div style="height: 250px;">
        <canvas id="quizChart"></canvas>
      </div>
    </div>
  </div>

  <!-- Right Panel -->
  <div class="w-full md:w-1/3 flex flex-col justify-between gap-6">

    <!-- Streak Info Box -->
    <div class="bg-midcolor p-4 rounded-lg shadow-md">
      <h3 class="text-lg font-semibold mb-2">Streak Info</h3>
      <p class="text-lightcolor dark:text-darkcolor">Current Streak: <span id="currentStreak" class="font-bold text-white">{{ streak }}</span></p>
      <p class="text-lightcolor dark:text-darkcolor">Today's Max Streak: <span id="maxStreak" class="font-bold text-white">{{ max_streak }}</span></p>
    </div>

    <!-- Song Box -->
    <div class="bg-midcolor p-4 rounded-lg shadow-md">
      <h3 class="text-lg font-semibold mb-2">Today's Song</h3>
      <div class="aspect-video">
        <iframe class="rounded-xl w-full h-40"
          src="{{ song.spotify_url }}"
          frameborder="0" allowfullscreen
          allow="autoplay; clipboard-write; encrypted-media; fullscreen; picture-in-picture"
          loading="lazy">
        </iframe>
      </div>
    </div>

  </div>
</div>
{% endblock %}

{% block scripts %}
<script>
  const max_streak = {{ max_streak or 0 }};
  const today_question_count = {{ today_question_count or 0 }};
</script>
<script src="{{ url_for('static', path='js/home_script.js') }}" defer></script>
{% endblock %}
